{% extends "profile_layout.html" %}
<style>
    .picbox
    {
        height: 3px;
        width: 3px;
        background-size: cover;
        float:right;
    }
    .la
    {
        float: right;
    }
</style>
{% block content2 %}
        <div class="card col-md-12 shadow">
            <div class="card-body">
                <div class="row">
                    <div class="col-md-8">
                        <div class="col-md-12" >
                            <div class="picbox" style="float:left;" id="lol">
                            </div>
                            <span class="la offset-0" style="margin-left:20px;margin:50px;"><font size="6"><strong id="usn" >{{user.username}}</strong></font></span>
                        </div>
                    </div>
                </div>
                <hr>
                <div class="row">
                    <div class="col-md-12">
                        <form method="POST" action="" enctype="multipart/form-data">
                            {{ form.hidden_tag() }}
                          <div class="form-group row">
                            <label for="username" class="col-2 col-form-label">User Name</label>
                            <div  id="username"  class="col-5">
                                {{ form.username(class="form-control form-control-lg",placeholder=user.username,disabled=True) }}
                            </div>
                          </div>
                          <div class="form-group row">
                            <label for="name" class="col-2 col-form-label">Name</label>
                            <div class="col-5" id="name">
                                {% if canEdit == 1 %}
                                    {{ form.name(class="form-control form-control-lg",placeholder=user.name) }}
                                {%endif%}

                                {% if canEdit == 0 %}
                                    {{ form.name(class="form-control form-control-lg",placeholder=user.name,disabled=True) }}
                                {%endif%}
                            </div>
                          </div>
                          <div class="form-group row">
                            <label for="email" class="col-2 col-form-label">Email</label>
                            <div class="col-5" id="email">
                                {{ form.email(class="form-control form-control-lg",placeholder=user.mail,disabled=True) }}
                            </div>
                          </div>

                            <div class="form-group row" id="hide0">
                            <label for="pass" class="col-2 col-form-label">Password</label>
                            <div class="col-5" id="pass">
                              {{ form.password(class="form-control form-control-lg") }}
                            </div>
                          </div>
                          <div class="form-group row hide" id="hide1">
                            <label for="newpass" class="col-2 col-form-label">New Password</label>
                            <div class="col-5" id="newpass">
                              {{ form.confirm(class="form-control form-control-lg") }}
                            </div>
                          </div>
                        <div class="form-group row hide" id="hide3">
                             <label for="newpass" class="col-2 col-form-label">Upload Pic</label>
                            <div class="la col-5">
                                <input type="file" name="userpic" class="la"></div>
                            <br>
                        </div>
                          <div class="form-group row hide" id="hide2">
                            <div class="offset-2 col-5 ">
                              {{ form.submit(class="btn btn-outline-info") }}
                            </div>
                          </div>

                        </form>
                    </div>
                </div>
            </div>
        </div>
<script >
    if ({{canEdit}} == 0 ){
        var sub = document.getElementById("hide0");
        sub.style.display = "none";

        var sub = document.getElementById("hide1");
        sub.style.display = "none";

        var sub = document.getElementById("hide2");
        sub.style.display = "none";

        var sub = document.getElementById("hide3");
        sub.style.display = "none";
    }


</script>
    <script type="text/javascript">
        function doesFileExist(urlToFile) {
            var xhr = new XMLHttpRequest();
            xhr.open('HEAD', urlToFile, false);
            xhr.send();
            //alert(xhr.status);
            if (xhr.status === 404) {
                return false;
            }
            else
            {
                return true;
            }
        }
    </script>
    <script>
        var result = doesFileExist("/static/uploads/"+document.getElementById("usn").innerText+".jpeg");
        //alert(result);
        if(result===true){
            var x="/static/uploads/"+document.getElementById("usn").innerHTML;
            x="\<img src="+"\""+x+".jpeg\""+ " height=\"150\" width=\"150\""+"\>";
            //alert(x);
            document.getElementById("lol").innerHTML=x;
        }
        else
            {
            var x="/static/uploads/"+"coder_avatar";
            x="\<img src="+"\""+x+".jpeg\""+ " height=\"150\" width=\"150\""+"\>";
            //alert(x);
            document.getElementById("lol").innerHTML=x;
        }
    </script>
{% endblock content2 %}